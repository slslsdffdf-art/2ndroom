<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>2nd Room – Wall</title>
  <link rel="stylesheet" href="/css/base.css" />
</head>
<body>
  <h1>사망자의 유언 목록</h1>
  <p>불운하게도, 탈출하지 못한 채 사망한 도전자들의 기록입니다.</p>
  <ul id="death-list"></ul>
  <script type="module">
    import { getDeaths } from '/js/api.js';

    const ul = document.getElementById('death-list');

    async function load() {
      const data = await getDeaths();
      ul.innerHTML = '';
      data.items.forEach(item => {
        const li = document.createElement('li');
        li.textContent = `[${item.time}] ${item.room} → ${item.death} ${item.cause ? '('+item.cause+')' : ''} ${item.will ? ' / '+item.will : ''}`;
        if (document.cookie.includes('admin=ok')) {
          const btn = document.createElement('button');
          btn.textContent = '삭제';
          btn.onclick = async () => {
            await fetch('/api/deaths/' + item.id, { method: 'DELETE' });
            load();
          };
          li.appendChild(btn);
        }
        ul.appendChild(li);
      });
    }

    load();
  </script>
</body>
</html>

